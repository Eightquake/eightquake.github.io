<html>
	<head>
		<title>Generation</title>
		<meta charset="UTF-8">
		<style>
			body {
				width:100%;
				height:100%;
				margin:0;
			}
		</style>
		<script>
			var canvas, context;
			var map = [], mWidth = 100, mHeight = 50, b = 0, rSteps = 3000;
			var keys = [], player = {y:mHeight/2, x:mWidth/2};
			window.onload = function() {
				canvas = document.getElementById("canvas");
				context = canvas.getContext("2d");
				canvas.width=window.innerWidth;
				canvas.height=window.innerHeight;
				b = Math.floor(canvas.height/mHeight);
				// fill entire map
				for(var y=0;y<mHeight;y++){
					map[y] = [];
					for(var x=0;x<mWidth;x++){
						map[y][x] = 1;
					}
				}
				// remove part of map
				var remove={y:mHeight/2, x:mWidth/2};
				for(var i=0;i<rSteps;i++){
					map[remove.y][remove.x] = 0;
					var dir = Math.random();
					if(dir < 0.25) {if(remove.x > 0) remove.x--;
					}else if(dir < 0.50) {if(remove.x < mWidth)remove.x++;
					}else if(dir < 0.75) {if(remove.y > 0)remove.y--;
					}else if(dir < 1) {if(remove.y < mHeight)remove.y++;}
				}
				
				draw();
			}
			window.onkeydown = function(e){
				console.log(e.keyCode);
				keys[e.keyCode] = true;
			}
			window.onkeyup = function(e){
				keys[e.keyCode] = false;
			}
			function draw(){
				requestAnimationFrame(draw);
				context.clearRect(0,0,canvas.width,canvas.height);
				context.fillStyle="#333";
				context.fillRect(0,0,canvas.width,canvas.height);
				for(var y=0;y<mHeight;y++){
					for(var x=0;x<mWidth;x++){
						context.fillStyle="#000";
						if(map[y][x]) {
							context.fillRect(x*b,y*b,b,b);
						}
					}
				}
				context.fillStyle="#F00";
				context.fillRect(player.x*b+1, player.y*b+1, b-1, b-2);
				
				if(keys[37] && !map[player.y][player.x-1]) {
					player.x--;
				}
				if(keys[39] && !map[player.y][player.x+1]) {
					player.x++;
				}
				if(keys[32] && !map[player.y-1][player.x]) {
					player.y--;
				}
				if(!keys[32] && !map[player.y+1][player.x]) {
					player.y++;
				}
			}
		</script>
	</head>
	<body>
		<canvas id="canvas"></canvas>
	</body>
</html>